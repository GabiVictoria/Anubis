{% extends 'principal/base.html' %}
{% load static %}
{% load i18n %} 

{% block styles %}<link rel="stylesheet" href="{% static 'principal/home.css' %}">{% endblock %}
   
{% block content %}

  <form method="get" action="{% url 'principal:pagina_de_busca' %}" class="search-bar-container">
    <input class="search-bar-input" type="text" name="q" placeholder="{% trans 'Buscar livros, clubes...' %}" value="{{ search_query|default:'' }}">
    <button class="search-bar-button" type="submit">
      <i class="fas fa-search"></i>
    </button>
  </form>

  <div class="container">
    <div class="carousel">
      <div class="carousel-item active">
        <img src="{% static 'img/slide1..png' %}" alt="{% trans 'Slide 1' %}">
      </div>
      <div class="carousel-item">
        <img src="{% static 'img/slide2.png' %}" alt="{% trans 'Slide 2' %}">
      </div>
      <div class="carousel-item">
        <img src="{% static 'img/slide3.png' %}" alt="{% trans 'Slide 3' %}">
      </div>
    </div>
  </div>

<div class="section">
    <h2>{% trans "Leituras Atuais" %}</h2>
    <div class="cards">
        {% for leitura in leituras_atuais %}
          <div class="card">
            <img src="{% if leitura.livro.capa %}{{ leitura.livro.capa.url }}{% else %}{% static 'img/default_book_cover.png' %}{% endif %}" alt="{{ leitura.livro.nome }}">
            <div class="card-content">
              <h3>{{ leitura.livro.nome }}</h3>
              <p class="texto-truncado">{{ leitura.clube.nome }}</p>
              <div class="progress-bar">
                <div class="progress" style="width: {{ leitura.percentual }}%"></div>
              </div>
              <div class="progress-info">{{ leitura.percentual }}% {% trans "concluído" %}</div>
            </div>
          </div>
        {% empty %}
          {# Mensagem que aparece se o usuário não estiver lendo nenhum livro #}
          <p style="grid-column: 1 / -1; text-align: center; padding: 20px;">
            {% trans "Você ainda não iniciou a leitura de nenhum livro nos seus clubes." %}
          </p>
        {% endfor %}
    </div>
</div>
  <div class="section">
    <h2>{% trans "Meus Clubes do Livro" %}</h2>
    {% if clubes_do_usuario %}
      <div class="cards">
        {% for clube_info in clubes_do_usuario %} 
  <a href="{% url 'principal:detalhes_clube' clube_info.id %}" class="link-card"> 
    <div class="card">
    {% if clube_info.capa_clube %}
        <img src="{{ clube_info.capa_clube.url }}" alt="{{ clube_info.nome }}">
    {% elif clube_info.capa_recomendada %}
        <img src="{% static clube_info.capa_recomendada %}" alt="{{ clube_info.nome }}">
    {% else %}
        <img src="{% static 'img/imgideal.png' %}" alt="{% trans 'Capa padrão' %}">
    {% endif %}
      <div class="card-content">
        <h3 class="texto-truncado">{{ clube_info.nome }}</h3>
        <p class="info-label texto-truncado">{% trans "Fundado por:" %} {{ clube_info.fundador_nome|default:"(a definir)" }}</p>
        <p class="info-label">{% trans "Desde:" %} {{ clube_info.data_criacao|date:"M Y"|default:"(a definir)" }}</p>
        <p class="info-label"><strong>{% trans "Membros:" %}</strong> {{ clube_info.membros_count }}</p>
        {% if clube_info.leitura_atual_nome %}
          <p class="info-label texto-truncado"><strong>{% trans "Lendo agora:" %}</strong> {{ clube_info.leitura_atual_nome }}</p>
        {% endif %}
      </div>
    </div>
  </a> 
  {% endfor %}
      </div>
    {% else %}
      <div class="no-clubs-message" style="text-align:center; padding: 20px; margin-top: 20px; background-color: #f0f0f0; border-radius: 8px;">
        <p>{% blocktrans %}Olá, {{ nome_usuario }}! Você ainda não faz parte de nenhum clube.{% endblocktrans %}</p>
        
    
        <p>
            {% trans "Que tal" %}
            <a href="{% url 'principal:criar_clube' %}">{% trans "criar um novo clube" %}</a>
            {% trans "ou explorar clubes existentes?" %}
        </p>
       
        
      </div>
    {% endif %}
  </div>

  <div class="section">
    <h2>{% trans "Recomendações de Clubes" %}</h2>
    <div class="cards">
      <div class="card">
        <img src="{% static 'img/epico.jpg' %}" alt="{% trans 'Fantasia Épica' %}">
        <div class="card-content">
          <h3>{% trans "Fantasia Épica" %}</h3>
          <p class="info-label">{% trans "Fundado por Júlia Ramos" %}</p>
          <p class="info-label">{% trans "Desde Fev 2024" %}</p>
          <p class="info-label"><strong>{% trans "Membros:" %}</strong> 50</p>
        </div>
      </div>
      <div class="card">
        <img src="{% static 'img/classicos.jpg' %}" alt="{% trans 'Literatura Brasileira' %}">
        <div class="card-content">
          <h3>{% trans "Literatura Brasileira" %}</h3>
          <p class="info-label">{% trans "Fundado por Pedro Souza" %}</p>
          <p class="info-label">{% trans "Desde Abr 2024" %}</p>
          <p class="info-label"><strong>{% trans "Membros:" %}</strong> 90</p>
        </div>
      </div>
      <div class="card">
        <img src="{% static 'img/futuro.jpg' %}" alt="{% trans 'Sci-Fi e Futuro' %}">
        <div class="card-content">
          <h3>{% trans "Sci-Fi e Futuro" %}</h3>
          <p class="info-label">{% trans "Fundado por Renan Costa" %}</p>
          <p class="info-label">{% trans "Desde Jan 2024" %}</p>
          <p class="info-label"><strong>{% trans "Membros:" %}</strong> 77</p>
        </div>
      </div>
    </div>
  </div>
  {% block scripts %}<script defer src="{% static 'principal/js/home.js' %}"></script>{% endblock %}
  
{% endblock %}